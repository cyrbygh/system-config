#!/bin/bash

# Get the directory of this script, then find encrypt.sh relative to repo root
REPO_ROOT="$(git rev-parse --show-toplevel)"

# Check if files need encryption before allowing the commit.
if ! "${REPO_ROOT}/encrypt.sh" --check; then
    echo ""
    echo "❌ Pre-commit hook failed: Files need encryption."
    echo "   Run 'cfg-encrypt' to encrypt files, then commit again."
    echo ""
    exit 1
fi

echo "✅ All encrypted files are up to date."
